2025-10-25 03:43:16,951 - __main__ - INFO - 🚀 开始运行聊天工具完整测试套件
2025-10-25 03:43:16,951 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_basic.TestBasicTools
2025-10-25 03:43:17,032 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_basic 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:17,032 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_basic 失败详情:
2025-10-25 03:43:17,032 - __main__ - ERROR - 💥 测试运行器崩溃: 'method'
2025-10-25 03:43:26,588 - __main__ - INFO - 🚀 开始运行聊天工具完整测试套件
2025-10-25 03:43:26,588 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_basic.TestBasicTools
2025-10-25 03:43:26,656 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_basic 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:26,657 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_basic 失败详情:
2025-10-25 03:43:26,657 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:26,657 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_task_crud.TestTaskCrudTools
2025-10-25 03:43:26,657 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_task_crud 运行失败: invalid syntax. Perhaps you forgot a comma? (test_task_crud.py, line 79)
2025-10-25 03:43:26,657 - __main__ - ERROR - ❌ tests.domains.chat.test_task_crud 失败详情:
2025-10-25 03:43:26,657 - __main__ - ERROR -    - 未知方法: invalid syntax. Perhaps you forgot a comma? (test_task_crud.py, line 79)
2025-10-25 03:43:26,657 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_task_search.TestSearchTasks
2025-10-25 03:43:27,298 - src.domains.chat.context_manager - INFO - 上下文管理器初始化: max_messages=20, max_tokens=None
2025-10-25 03:43:27,298 - src.domains.chat.database - INFO - 聊天内存存储创建成功
2025-10-25 03:43:27,298 - src.domains.chat.tools.task_search - INFO - 开始搜索任务: query='编程相关任务', limit=50, state=None
2025-10-25 03:43:27,298 - src.domains.chat.tools.task_search - INFO - 任务搜索完成: 找到2个任务，估算87tokens
2025-10-25 03:43:27,298 - __main__ - INFO - ✅ test_search_tasks_basic_functionality 通过
2025-10-25 03:43:27,298 - src.domains.chat.tools.task_search - INFO - 开始搜索任务: query='长描述任务', limit=50, state=None
2025-10-25 03:43:27,298 - src.domains.chat.tools.task_search - INFO - 任务搜索完成: 找到1个任务，估算69tokens
2025-10-25 03:43:27,298 - __main__ - INFO - ✅ test_search_tasks_description_truncation 通过
2025-10-25 03:43:27,298 - src.domains.chat.tools.task_search - INFO - 搜索限制调整为100个任务
2025-10-25 03:43:27,298 - src.domains.chat.tools.task_search - INFO - 开始搜索任务: query='测试任务', limit=100, state=None
2025-10-25 03:43:27,299 - src.domains.chat.tools.task_search - INFO - 任务搜索完成: 找到0个任务，估算0tokens
2025-10-25 03:43:27,299 - __main__ - INFO - ✅ test_search_tasks_limit_adjustment 通过
2025-10-25 03:43:27,299 - src.domains.chat.tools.task_search - INFO - 开始搜索任务: query='大量任务搜索', limit=20, state=None
2025-10-25 03:43:27,299 - src.domains.chat.tools.task_search - INFO - 任务搜索完成: 找到20个任务，估算1155tokens
2025-10-25 03:43:27,299 - __main__ - INFO - ✅ test_search_tasks_limit_optimization 通过
2025-10-25 03:43:27,299 - src.domains.chat.tools.task_search - INFO - 开始搜索任务: query='未完成任务', limit=30, state=pending
2025-10-25 03:43:27,299 - src.domains.chat.tools.task_search - INFO - 任务搜索完成: 找到1个任务，估算44tokens
2025-10-25 03:43:27,299 - __main__ - INFO - ✅ test_search_tasks_with_state_filter 通过
2025-10-25 03:43:27,299 - __main__ - INFO - 📊 tests.domains.chat.test_task_search 结果: 5/5 通过 (100.0%)
2025-10-25 03:43:27,299 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_task_batch.TestBatchCreateSubtasks
2025-10-25 03:43:27,301 - src.domains.chat.tools.task_batch - INFO - 🔧 批量创建子任务工具被调用，父任务ID: ed8a1778-afbe-4f1c-a85b-73fa7cad1741, 子任务数量: 3, 用户ID: b979ff81-65e2-4510-8e05-17e63e19aa9f
2025-10-25 03:43:27,301 - src.domains.chat.tools.task_batch - INFO - 开始批量创建 3 个子任务
2025-10-25 03:43:27,301 - src.domains.chat.tools.task_batch - INFO - 批量创建完成: 成功 3, 失败 0, 总计 3
2025-10-25 03:43:27,301 - __main__ - INFO - ✅ test_batch_create_subtasks_all_success 通过
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - INFO - 🔧 批量创建子任务工具被调用，父任务ID: c40e8728-53f3-4553-9b72-a92faf85f242, 子任务数量: 0, 用户ID: f24d3764-e88e-4c37-9998-6d340d5c98a0
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - INFO - 子任务列表为空，直接返回成功
2025-10-25 03:43:27,302 - __main__ - INFO - ✅ test_batch_create_subtasks_empty_subtasks 通过
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - INFO - 🔧 批量创建子任务工具被调用，父任务ID: ebb2073b-62b4-430e-9247-a0448f0c1d5a, 子任务数量: 3, 用户ID: 140b6bf5-cdf9-467e-a212-a8d2d12d0e22
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - WARNING - 子任务 1 格式验证失败: 子任务必须是字典格式，当前类型: str
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - WARNING - 子任务 2 格式验证失败: 子任务缺少必需的 'title' 字段
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - WARNING - 子任务 3 格式验证失败: 子任务标题不能为空
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - ERROR - 批量创建子任务参数验证失败: 所有子任务格式都无效，无法创建任何子任务
2025-10-25 03:43:27,302 - __main__ - ERROR - ❌ test_batch_create_subtasks_invalid_subtask_format 失败: 
2025-10-25 03:43:27,302 - src.domains.chat.tools.task_batch - INFO - 🔧 批量创建子任务工具被调用，父任务ID: 93dcb1e1-9023-4e81-b6be-b3f1a6ac0c9d, 子任务数量: 1, 用户ID: 19d5c7ee-07de-4c4a-9d19-59629a1285e4
2025-10-25 03:43:27,302 - __main__ - INFO - ✅ test_batch_create_subtasks_parent_not_found 通过
2025-10-25 03:43:27,303 - src.domains.chat.tools.task_batch - INFO - 🔧 批量创建子任务工具被调用，父任务ID: e3e56062-70b6-45a0-8833-c079d4dd58c9, 子任务数量: 3, 用户ID: 72a07fcb-ddc1-4b22-a434-0703b5254d1d
2025-10-25 03:43:27,303 - src.domains.chat.tools.task_batch - INFO - 开始批量创建 3 个子任务
2025-10-25 03:43:27,303 - src.domains.chat.tools.task_batch - ERROR - 子任务 2 创建失败: 创建子任务失败: 创建失败：标题重复
2025-10-25 03:43:27,303 - src.domains.chat.tools.task_batch - INFO - 批量创建完成: 成功 2, 失败 1, 总计 3
2025-10-25 03:43:27,303 - __main__ - INFO - ✅ test_batch_create_subtasks_partial_failure 通过
2025-10-25 03:43:27,303 - src.domains.chat.tools.task_batch - INFO - 🔧 批量创建子任务工具被调用，父任务ID: d3ecb65b-d5a3-4ca8-b0cf-cf45ea026334, 子任务数量: 1, 用户ID: a1c60ff5-e811-48a0-8b48-a4cc0c2bcf90
2025-10-25 03:43:27,303 - __main__ - INFO - ✅ test_batch_create_subtasks_permission_denied 通过
2025-10-25 03:43:27,303 - __main__ - INFO - 📊 tests.domains.chat.test_task_batch 结果: 5/6 通过 (83.3%)
2025-10-25 03:43:27,303 - __main__ - ERROR - ❌ tests.domains.chat.test_task_batch 失败详情:
2025-10-25 03:43:27,303 - __main__ - ERROR -    - test_batch_create_subtasks_invalid_subtask_format: 
2025-10-25 03:43:27,303 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_integration.TestCompleteWorkflow
2025-10-25 03:43:27,306 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_integration 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,306 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_integration 失败详情:
2025-10-25 03:43:27,306 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,306 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_integration.TestToolChaining
2025-10-25 03:43:27,306 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_integration 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,306 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_integration 失败详情:
2025-10-25 03:43:27,306 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,306 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_integration.TestErrorHandlingAndRecovery
2025-10-25 03:43:27,306 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_integration 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_integration 失败详情:
2025-10-25 03:43:27,307 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_integration.TestPerformanceIntegration
2025-10-25 03:43:27,307 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_integration 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_integration 失败详情:
2025-10-25 03:43:27,307 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_integration.TestRealWorldScenarios
2025-10-25 03:43:27,307 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_integration 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_integration 失败详情:
2025-10-25 03:43:27,307 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - INFO - 🔄 开始运行测试模块: tests.domains.chat.test_chat_tools_integration.TestLangGraphIntegration
2025-10-25 03:43:27,307 - __main__ - ERROR - 💥 测试模块 tests.domains.chat.test_chat_tools_integration 运行失败: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,307 - __main__ - ERROR - ❌ tests.domains.chat.test_chat_tools_integration 失败详情:
2025-10-25 03:43:27,307 - __main__ - ERROR -    - 未知方法: cannot import name 'uuid' from 'uuid' (/Users/zalelee/.local/share/uv/python/cpython-3.12.11-macos-aarch64-none/lib/python3.12/uuid.py)
2025-10-25 03:43:27,308 - __main__ - ERROR - ❌ 存在测试失败！
