#!/bin/bash
# æœåŠ¡å™¨ç«¯SSHé—®é¢˜æ’æŸ¥å‘½ä»¤

echo "=================================="
echo "ğŸ”§ æœåŠ¡å™¨ç«¯SSHé—®é¢˜æ’æŸ¥å‘½ä»¤"
echo "=================================="

echo ""
echo "1. æ£€æŸ¥SSHæœåŠ¡çŠ¶æ€ï¼š"
echo "   systemctl status sshd"
echo "   # å¦‚æœæ²¡æœ‰è¿è¡Œï¼Œå¯åŠ¨å®ƒï¼š"
echo "   systemctl start sshd"
echo "   systemctl enable sshd"
echo ""

echo "2. æ£€æŸ¥SSHé…ç½®ï¼š"
echo "   cat /etc/ssh/sshd_config | grep -E '(PermitRootLogin|PasswordAuthentication|PubkeyAuthentication)'"
echo "   # ç¡®ä¿é…ç½®æ­£ç¡®ï¼š"
echo "   PermitRootLogin yes"
echo "   PasswordAuthentication yes"
echo "   PubkeyAuthentication yes"
echo ""

echo "3. é‡å¯SSHæœåŠ¡ï¼š"
echo "   systemctl restart sshd"
echo ""

echo "4. æ£€æŸ¥SSHæ—¥å¿—ï¼š"
echo "   tail -f /var/log/auth.log"
echo "   # æˆ–è€…ï¼š"
echo "   journalctl -u sshd -f"
echo ""

echo "5. æ£€æŸ¥é˜²ç«å¢™çŠ¶æ€ï¼š"
echo "   ufw status"
echo "   # å¦‚æœSSHç«¯å£è¢«é˜»æ­¢ï¼š"
echo "   ufw allow 22/tcp"
echo ""

echo "6. æ£€æŸ¥fail2bançŠ¶æ€ï¼š"
echo "   fail2ban-client status"
echo "   fail2ban-client status sshd"
echo "   # å¦‚æœIPè¢«é˜»æ­¢ï¼Œè§£å°ï¼š"
echo "   fail2ban-client set sshd unbanip YOUR_IP_ADDRESS"
echo ""

echo "7. æ£€æŸ¥ç³»ç»Ÿèµ„æºï¼š"
echo "   free -h"
echo "   df -h"
echo "   top"
echo ""

echo "8. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼š"
echo "   netstat -tlnp | grep :22"
echo "   ss -tlnp | grep :22"
echo ""

echo "9. æµ‹è¯•SSHè¿æ¥ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰ï¼š"
echo "   ssh localhost"
echo "   ssh root@localhost"
echo ""

echo "10. é‡æ–°ç”ŸæˆSSHä¸»æœºå¯†é’¥ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼š"
echo "    rm /etc/ssh/ssh_host_*"
echo "    ssh-keygen -A"
echo "    systemctl restart sshd"
echo ""

echo "=================================="
echo "ğŸ’¡ å¸¸è§è§£å†³æ­¥éª¤ï¼š"
echo "1. å…ˆæ£€æŸ¥SSHæœåŠ¡çŠ¶æ€å’Œæ—¥å¿—"
echo "2. æŸ¥çœ‹æ˜¯å¦æœ‰IPè¢«fail2bané˜»æ­¢"
echo "3. é‡å¯SSHæœåŠ¡"
echo "4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®"
echo "=================================="